# 要求定義: 走者進塁・アウト記録

## 背景と課題

現在の`scoreStore.ts`は`runnersOnBase: Record<1|2|3, string|null>`を持っているが、
打席結果が確定した後に走者の位置が更新されていない（常にnull）。

- 四球・死球の自動確定時にフォースアドバンス（押し出し進塁）が適用されない
- 安打や打球結果後に走者がどの塁に進んだか記録できない
- `GameHeader`の走者インジケーターが常に空欄になっている

## 実装する機能

### 1. 四球・死球のフォースアドバンス自動適用

四球（`recordPitch`内の4ボール自動確定）および死球（HBP自動確定）時：
- 打者は1塁へ
- 1塁に走者がいれば2塁へ（フォース）
- 1・2塁に走者がいれば3塁へ（フォース）
- 満塁なら3塁走者は得点（塁から消える）

### 2. インプレー結果後の走者進塁入力フェーズ

打席結果が確定した後、走者がいる場合または打者が出塁する場合は：
- 新フェーズ `'runner_advance'` に移行する
- `RunnerAdvancePanel`コンポーネントを表示
- 各走者（既存の塁上走者）の移動先を入力
- 打者の到達塁は結果から自動決定（単打=1塁、二塁打=2塁、三塁打=3塁、本塁打=得点）

### 3. 走者進塁確定

`confirmRunners`アクション呼び出し後：
- `runnersOnBase`を更新
- 次打者へ移行（または`inning_end`）

## スコープ外（MVP除外）

- 盗塁・盗塁死・暴投・パスボール等のバッテリー間プレー（別機能として実装予定）
- 走者のアウト時の守備記号記録（将来のBaseEvent対応）
- 得点の自動集計（この機能ではrunnersOnBaseの正確な管理にフォーカス）

## 受け入れ基準

- 四球/死球後にフォースアドバンスが正しく適用される
- 安打後に`runner_advance`フェーズへ遷移する
- 走者なし・打者アウトの場合は`runner_advance`をスキップして次打者へ
- `RunnerAdvancePanel`で各走者の移動先を選択できる
- 「確定」ボタンで`runnersOnBase`が更新される
- `GameHeader`の走者インジケーターが正しく更新される
- Undoが正しく動作する（confirmRunners前の状態に戻れる）
